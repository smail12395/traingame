<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø³ÙƒÙƒ</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(5, 60px);
      grid-template-rows: repeat(5, 60px);
      gap: 2px;
      margin-bottom: 20px;
    }

    .cell {
      background: #ddd;
      border: 1px solid #aaa;
      position: relative;
    }

    .track {
      background: #999;
    }

    .switch {
      background: #666;
      cursor: pointer;
    }

    .train {
      width: 20px;
      height: 20px;
      background: red;
      border-radius: 50%;
      position: absolute;
      top: 20px;
      left: 20px;
      transition: all 0.4s ease;
    }

    .controls {
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h2>ðŸš‚ Ù„Ø¹Ø¨Ø© Ø§Ù„Ø³ÙƒÙƒ Ø§Ù„Ù…Ø¨Ø³Ø·Ø©</h2>
  <div class="grid" id="grid"></div>
  <div class="controls">
    <button onclick="startTrain()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù‚Ø·Ø§Ø±</button>
  </div>

  <script>
    const grid = document.getElementById("grid");
    const rows = 5;
    const cols = 5;

    const trainPath = [
      {x: 0, y: 2},
      {x: 1, y: 2},
      {x: 2, y: 2}, // switch here
      {x: 3, y: 2},
      {x: 4, y: 2}
    ];

    let switchState = "straight"; // or "down"

    // Build grid
    let cells = [];
    for (let y = 0; y < rows; y++) {
      for (let x = 0; x < cols; x++) {
        const cell = document.createElement("div");
        cell.classList.add("cell");

        // add horizontal track on row 2
        if (y === 2) cell.classList.add("track");

        // add switch
        if (x === 2 && y === 2) {
          cell.classList.add("switch");
          cell.title = "Click to change direction";
          cell.addEventListener("click", () => {
            switchState = switchState === "straight" ? "down" : "straight";
            updateSwitchVisual();
          });
        }

        grid.appendChild(cell);
        cells.push(cell);
      }
    }

    // Create train
    const train = document.createElement("div");
    train.classList.add("train");
    cells[2].appendChild(train); // position at (0,2)

    function getCell(x, y) {
      return cells[y * cols + x];
    }

    function updateSwitchVisual() {
      const switchCell = getCell(2, 2);
      switchCell.style.background = switchState === "straight" ? "#666" : "#2e8b57";
    }

    function startTrain() {
      let index = 0;

      const interval = setInterval(() => {
        const pos = trainPath[index];
        const next = trainPath[index + 1];

        if (!next) {
          clearInterval(interval);
          return;
        }

        if (pos.x === 2 && pos.y === 2 && switchState === "down") {
          // If switch turned, go down instead
          moveTrain(2, 3); // down
          clearInterval(interval);
          return;
        }

        moveTrain(next.x, next.y);
        index++;
      }, 700);
    }

    function moveTrain(x, y) {
      const targetCell = getCell(x, y);
      targetCell.appendChild(train);
    }

    updateSwitchVisual();
  </script>
</body>
</html>
